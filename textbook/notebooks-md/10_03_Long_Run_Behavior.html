
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>10.3 Long Run Behavior Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="10_04_Examples.html" />
    
    
    <link rel="prev" href="10_02_Deconstructing_Chains.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="http://prob140.org/" target="_blank" class="custom-link">Main Prob140 Site</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Authors and License
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="To_the_Student.html">
            
                <a href="To_the_Student.html">
            
                    
                    To the Student
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="1_00_Fundamentals.html">
            
                <a href="1_00_Fundamentals.html">
            
                    
                    Chapter 1: Fundamentals
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="1_01_Outcome_Space_and_Events.html">
            
                <a href="1_01_Outcome_Space_and_Events.html">
            
                    
                    1.1 Outcome Space and Events
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="1_02_Equally_Likely_Outcomes.html">
            
                <a href="1_02_Equally_Likely_Outcomes.html">
            
                    
                    1.2 Equally Likely Outcomes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="1_03_Collisions_in_Hashing.html">
            
                <a href="1_03_Collisions_in_Hashing.html">
            
                    
                    1.3 Collisions in Hashing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="1_04_Birthday_Problem.html">
            
                <a href="1_04_Birthday_Problem.html">
            
                    
                    1.4 The Birthday Problem
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5" data-path="1_05_An_Exponential_Approximation.html">
            
                <a href="1_05_An_Exponential_Approximation.html">
            
                    
                    1.5 An Exponential Approximation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="2_00_Calculating_Chances.html">
            
                <a href="2_00_Calculating_Chances.html">
            
                    
                    Chapter 2: Calculating Chances
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="2_01_Addition.html">
            
                <a href="2_01_Addition.html">
            
                    
                    2.1 Addition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.2" data-path="2_02_Examples.html">
            
                <a href="2_02_Examples.html">
            
                    
                    2.2 Examples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.3" data-path="2_03_Multiplication.html">
            
                <a href="2_03_Multiplication.html">
            
                    
                    2.3 Multiplication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.4" data-path="2_04_More_Examples.html">
            
                <a href="2_04_More_Examples.html">
            
                    
                    2.4 More Examples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.5" data-path="2_05_Updating_Probabilities.html">
            
                <a href="2_05_Updating_Probabilities.html">
            
                    
                    2.5 Updating Probabilities
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="3_00_Random_Variables.html">
            
                <a href="3_00_Random_Variables.html">
            
                    
                    Chapter 3: Random Variables
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.1" data-path="3_01_Functions_on_an_Outcome_Space.html">
            
                <a href="3_01_Functions_on_an_Outcome_Space.html">
            
                    
                    3.1 Functions on an Outcome Space
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.2" data-path="3_02_Distributions.html">
            
                <a href="3_02_Distributions.html">
            
                    
                    3.2 Distributions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3" data-path="3_03_Equality.html">
            
                <a href="3_03_Equality.html">
            
                    
                    3.3 Equality
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="4_00_Relations_Between_Variables.html">
            
                <a href="4_00_Relations_Between_Variables.html">
            
                    
                    Chapter 4: Relations Between Variables
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.1" data-path="4_01_Joint_Distributions.html">
            
                <a href="4_01_Joint_Distributions.html">
            
                    
                    4.1 Joint Distributions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.2" data-path="4_02_Marginal_Distributions.html">
            
                <a href="4_02_Marginal_Distributions.html">
            
                    
                    4.2 Marginal Distributions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.3" data-path="4_03_Conditional_Distributions.html">
            
                <a href="4_03_Conditional_Distributions.html">
            
                    
                    4.3 Conditional Distributions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.4" data-path="4_04_Updating_Distributions.html">
            
                <a href="4_04_Updating_Distributions.html">
            
                    
                    4.4 Updating Distributions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.5" data-path="4_05_Dependence_and_Independence.html">
            
                <a href="4_05_Dependence_and_Independence.html">
            
                    
                    4.5 Dependence and Independence
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="5_00_Collections_of_Events.html">
            
                <a href="5_00_Collections_of_Events.html">
            
                    
                    Chapter 5: Collections of Events
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.5.1" data-path="5_01_Bounding_the_Chance_of_a_Union.html">
            
                <a href="5_01_Bounding_the_Chance_of_a_Union.html">
            
                    
                    5.1 Bounding the Chance of a Union
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.2" data-path="5_02_Inclusion_Exclusion.html">
            
                <a href="5_02_Inclusion_Exclusion.html">
            
                    
                    5.2 Inclusion-Exclusion
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.3" data-path="5_03_The_Matching_Problem.html">
            
                <a href="5_03_The_Matching_Problem.html">
            
                    
                    5.3 The Matching Problem
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.4" data-path="5_04_Sampling_Without_Replacement.html">
            
                <a href="5_04_Sampling_Without_Replacement.html">
            
                    
                    5.4 Sampling Without Replacement
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="6_00_Random_Counts.html">
            
                <a href="6_00_Random_Counts.html">
            
                    
                    Chapter 6: Random Counts
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.6.1" data-path="6_01_Binomial_Distribution.html">
            
                <a href="6_01_Binomial_Distribution.html">
            
                    
                    6.1 The Binomial Distribution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6.2" data-path="6_02_Examples.html">
            
                <a href="6_02_Examples.html">
            
                    
                    6.2 Examples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6.3" data-path="6_03_Hypergeometric_Distribution.html">
            
                <a href="6_03_Hypergeometric_Distribution.html">
            
                    
                    6.3 The Hypergeometric Distribution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6.4" data-path="6_04_Odds_Ratios.html">
            
                <a href="6_04_Odds_Ratios.html">
            
                    
                    6.4 Odds Ratios
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6.5" data-path="6_05_Law_of_Small_Numbers.html">
            
                <a href="6_05_Law_of_Small_Numbers.html">
            
                    
                    6.5 The Law of Small Numbers
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="7_00_Poissonization.html">
            
                <a href="7_00_Poissonization.html">
            
                    
                    Chapter 7: Poissonization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.7.1" data-path="7_01_Poissonizing_the_Binomial.html">
            
                <a href="7_01_Poissonizing_the_Binomial.html">
            
                    
                    7.1 Poissonizing the Binomial
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7.2" data-path="7_02_Poissonizing_the_Multinomial.html">
            
                <a href="7_02_Poissonizing_the_Multinomial.html">
            
                    
                    7.2 Poissonizing the Multinomial
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="8_00_Expectation.html">
            
                <a href="8_00_Expectation.html">
            
                    
                    Chapter 8: Expectation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.8.1" data-path="8_01_Definition.html">
            
                <a href="8_01_Definition.html">
            
                    
                    8.1 Definition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.8.2" data-path="8_02_Additivity.html">
            
                <a href="8_02_Additivity.html">
            
                    
                    8.2 Additivity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.8.3" data-path="8_03_Expectations_of_Functions.html">
            
                <a href="8_03_Expectations_of_Functions.html">
            
                    
                    8.3 Expectations of Functions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="9_00_Conditioning_Revisited.html">
            
                <a href="9_00_Conditioning_Revisited.html">
            
                    
                    Chapter 9: Conditioning, Revisited
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.9.1" data-path="9_01_Probability_by_Conditioning.html">
            
                <a href="9_01_Probability_by_Conditioning.html">
            
                    
                    9.1 Probability by Conditioning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.2" data-path="9_02_Expectation_by_Conditioning.html">
            
                <a href="9_02_Expectation_by_Conditioning.html">
            
                    
                    9.2 Expectation by Conditioning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.3" data-path="9_03_Expected_Waiting_Times.html">
            
                <a href="9_03_Expected_Waiting_Times.html">
            
                    
                    9.3 Expected Waiting Times
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.10" data-path="10_00_Markov_Chains.html">
            
                <a href="10_00_Markov_Chains.html">
            
                    
                    Chapter 10: Markov Chains
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.10.1" data-path="10_01_Transitions.html">
            
                <a href="10_01_Transitions.html">
            
                    
                    10.1 Transitions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.10.2" data-path="10_02_Deconstructing_Chains.html">
            
                <a href="10_02_Deconstructing_Chains.html">
            
                    
                    10.2 Deconstructing Chains
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.10.3" data-path="10_03_Long_Run_Behavior.html">
            
                <a href="10_03_Long_Run_Behavior.html">
            
                    
                    10.3 Long Run Behavior
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.10.4" data-path="10_04_Examples.html">
            
                <a href="10_04_Examples.html">
            
                    
                    10.4 Examples
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.11" data-path="11_00_Reversing_Markov_Chains.html">
            
                <a href="11_00_Reversing_Markov_Chains.html">
            
                    
                    Chapter 11: Reversing Markov Chains
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.11.1" data-path="11_01_Detailed_Balance.html">
            
                <a href="11_01_Detailed_Balance.html">
            
                    
                    11.1 Detailed Balance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.11.2" data-path="11_02_Reversibility.html">
            
                <a href="11_02_Reversibility.html">
            
                    
                    11.2 Reversibility
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.11.3" data-path="11_03_Code_Breaking.html">
            
                <a href="11_03_Code_Breaking.html">
            
                    
                    11.3 Code Breaking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.11.4" data-path="11_04_Markov_Chain_Monte_Carlo.html">
            
                <a href="11_04_Markov_Chain_Monte_Carlo.html">
            
                    
                    11.4 Markov Chain Monte Carlo
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.12" data-path="12_00_Standard_Deviation.html">
            
                <a href="12_00_Standard_Deviation.html">
            
                    
                    Chapter 12: Standard Deviation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.12.1" data-path="12_01_Definition.html">
            
                <a href="12_01_Definition.html">
            
                    
                    12.1 Definition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.12.2" data-path="12_02_Prediction_and_Estimation.html">
            
                <a href="12_02_Prediction_and_Estimation.html">
            
                    
                    12.2 Prediction and Estimation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.12.3" data-path="12_03_Bounds.html">
            
                <a href="12_03_Bounds.html">
            
                    
                    12.3 Tail Bounds
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.12.4" data-path="12_04_Heavy_Tails.html">
            
                <a href="12_04_Heavy_Tails.html">
            
                    
                    12.4 Heavy Tails
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.13" data-path="13_00_Variance_Via_Covariance.html">
            
                <a href="13_00_Variance_Via_Covariance.html">
            
                    
                    Chapter 13: Variance Via Covariance
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.13.1" data-path="13_01_Properties_of_Covariance.html">
            
                <a href="13_01_Properties_of_Covariance.html">
            
                    
                    13.1 Properties of Covariance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.13.2" data-path="13_02_Sums_of_IID_Samples.html">
            
                <a href="13_02_Sums_of_IID_Samples.html">
            
                    
                    13.2 Sums of IID Samples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.13.3" data-path="13_03_Sums_of_Simple_Random_Samples.html">
            
                <a href="13_03_Sums_of_Simple_Random_Samples.html">
            
                    
                    13.3 Sums of Simple Random Samples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.13.4" data-path="13_04_Finite_Population_Correction.html">
            
                <a href="13_04_Finite_Population_Correction.html">
            
                    
                    13.4 Finite Population Correction
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.14" data-path="14_00_The_Central_Limit_Theorem.html">
            
                <a href="14_00_The_Central_Limit_Theorem.html">
            
                    
                    Chapter 14: The Central Limit Theorem
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.14.1" data-path="14_01_Exact_Distribution.html">
            
                <a href="14_01_Exact_Distribution.html">
            
                    
                    14.1 Exact Distribution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.14.2" data-path="14_02_PGFs_in_NumPy.html">
            
                <a href="14_02_PGFs_in_NumPy.html">
            
                    
                    14.2 PGFs in NumPy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.14.3" data-path="14_03_Central_Limit_Theorem.html">
            
                <a href="14_03_Central_Limit_Theorem.html">
            
                    
                    14.3 Central Limit Theorem
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.14.4" data-path="14_04_The_Sample_Mean.html">
            
                <a href="14_04_The_Sample_Mean.html">
            
                    
                    14.4 The Sample Mean
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.14.5" data-path="14_05_Confidence_Intervals.html">
            
                <a href="14_05_Confidence_Intervals.html">
            
                    
                    14.5 Confidence Intervals
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.15" data-path="15_00_Continuous_Distributions.html">
            
                <a href="15_00_Continuous_Distributions.html">
            
                    
                    Chapter 15: Continuous Distributions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.15.1" data-path="15_01_Density_and_CDF.html">
            
                <a href="15_01_Density_and_CDF.html">
            
                    
                    15.1 Density and CDF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.15.2" data-path="15_02_The_Meaning_of_Density.html">
            
                <a href="15_02_The_Meaning_of_Density.html">
            
                    
                    15.2 The Meaning of Density
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.15.3" data-path="15_03_Expectation.html">
            
                <a href="15_03_Expectation.html">
            
                    
                    15.3 Expectation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.15.4" data-path="15_04_Exponential_Distribution.html">
            
                <a href="15_04_Exponential_Distribution.html">
            
                    
                    15.4 Exponential Distribution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.15.5" data-path="15_05_Calculus_in_SymPy.html">
            
                <a href="15_05_Calculus_in_SymPy.html">
            
                    
                    15.5 Calculus in SymPy
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.16" data-path="16_00_Transformations.html">
            
                <a href="16_00_Transformations.html">
            
                    
                    Chapter 16: Transformations
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.16.1" data-path="16_01_Linear_Transformations.html">
            
                <a href="16_01_Linear_Transformations.html">
            
                    
                    16.1 Linear Transformations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.16.2" data-path="16_02_Monotone_Functions.html">
            
                <a href="16_02_Monotone_Functions.html">
            
                    
                    16.2 Monotone Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.16.3" data-path="16_03_Two_to_One_Functions.html">
            
                <a href="16_03_Two_to_One_Functions.html">
            
                    
                    16.3 Two-to-One Functions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.17" data-path="17_00_Joint_Densities.html">
            
                <a href="17_00_Joint_Densities.html">
            
                    
                    Chapter 17: Joint Densities
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.17.1" data-path="17_01_Probabilities_and_Expectations.html">
            
                <a href="17_01_Probabilities_and_Expectations.html">
            
                    
                    17.1 Probabilities and Expectations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.17.2" data-path="17_02_Independence.html">
            
                <a href="17_02_Independence.html">
            
                    
                    17.2 Independence
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.17.3" data-path="17_03_Marginal_and_Conditional_Densities.html">
            
                <a href="17_03_Marginal_and_Conditional_Densities.html">
            
                    
                    17.3 Marginal and Conditional Densities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.17.4" data-path="17_04_Beta_Densities_with_Integer_Parameters.html">
            
                <a href="17_04_Beta_Densities_with_Integer_Parameters.html">
            
                    
                    17.4 Beta Densities with Integer Parameters
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.18" data-path="18_00_The_Normal_and_Gamma_Families.html">
            
                <a href="18_00_The_Normal_and_Gamma_Families.html">
            
                    
                    Chapter 18: The Normal and Gamma Families
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.18.1" data-path="18_01_Standard_Normal_Basics.html">
            
                <a href="18_01_Standard_Normal_Basics.html">
            
                    
                    18.1 Standard Normal: The Basics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.18.2" data-path="18_02_Sums_of_Independent_Normal_Variables.html">
            
                <a href="18_02_Sums_of_Independent_Normal_Variables.html">
            
                    
                    18.2 Sums of Independent Normal Variables
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.18.3" data-path="18_03_The_Gamma_Family.html">
            
                <a href="18_03_The_Gamma_Family.html">
            
                    
                    18.3 The Gamma Family
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.18.4" data-path="18_04_Chi_Squared_Distributions.html">
            
                <a href="18_04_Chi_Squared_Distributions.html">
            
                    
                    18.4 Chi-Squared Distributions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.19" data-path="19_00_Distributions_of_Sums.html">
            
                <a href="19_00_Distributions_of_Sums.html">
            
                    
                    Chapter 19: Distributions of Sums
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.19.1" data-path="19_01_Convolution_Formula.html">
            
                <a href="19_01_Convolution_Formula.html">
            
                    
                    19.1 The Convolution Formula
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.19.2" data-path="19_02_Moment_Generating_Functions.html">
            
                <a href="19_02_Moment_Generating_Functions.html">
            
                    
                    19.2 Moment Generating Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.19.3" data-path="19_03_MGFs_Normal_and_the_CLT.html">
            
                <a href="19_03_MGFs_Normal_and_the_CLT.html">
            
                    
                    19.3 MGFs, the Normal, and the CLT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.19.4" data-path="19_04_Chernoff_Bound.html">
            
                <a href="19_04_Chernoff_Bound.html">
            
                    
                    19.4 Chernoff Bound
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.20" data-path="20_00_Approaches_to_Estimation.html">
            
                <a href="20_00_Approaches_to_Estimation.html">
            
                    
                    Chapter 20: Approaches to Estimation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.20.1" data-path="20_01_Maximum_Likelihood.html">
            
                <a href="20_01_Maximum_Likelihood.html">
            
                    
                    20.1 Maximum Likelihood
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.20.2" data-path="20_02_Prior_and_Posterior.html">
            
                <a href="20_02_Prior_and_Posterior.html">
            
                    
                    20.2 Prior and Posterior
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.20.3" data-path="20_03_Independence_Revisited.html">
            
                <a href="20_03_Independence_Revisited.html">
            
                    
                    20.3 Independence, Revisited
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.21" data-path="21_00_The_Beta_and_the_Binomial.html">
            
                <a href="21_00_The_Beta_and_the_Binomial.html">
            
                    
                    Chapter 21: The Beta and the Binomial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.21.1" data-path="21_01_Updating_and_Prediction.html">
            
                <a href="21_01_Updating_and_Prediction.html">
            
                    
                    21.1 Updating and Prediction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.21.2" data-path="21_02_Beta_Binomial_Distribution.html">
            
                <a href="21_02_Beta_Binomial_Distribution.html">
            
                    
                    21.2 The Beta-Binomial Distribution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.21.3" data-path="21_03_Long_Run_Proportion_of_Heads.html">
            
                <a href="21_03_Long_Run_Proportion_of_Heads.html">
            
                    
                    21.3 Long Run Proportion of Heads
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.22" data-path="22_00_Prediction.html">
            
                <a href="22_00_Prediction.html">
            
                    
                    Chapter 22: Prediction
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.22.1" data-path="22_01_Conditional_Expectation_Projection.html">
            
                <a href="22_01_Conditional_Expectation_Projection.html">
            
                    
                    22.1 Conditional Expectation As a Projection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.22.2" data-path="22_02_Variance_by_Conditioning.html">
            
                <a href="22_02_Variance_by_Conditioning.html">
            
                    
                    22.2 Variance by Conditioning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.22.3" data-path="22_03_Examples.html">
            
                <a href="22_03_Examples.html">
            
                    
                    22.3 Examples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.22.4" data-path="22_04_Least_Squares_Predictor.html">
            
                <a href="22_04_Least_Squares_Predictor.html">
            
                    
                    22.4 Least Squares Predictor
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.23" data-path="23_00_Multivariate_Normal_RVs.html">
            
                <a href="23_00_Multivariate_Normal_RVs.html">
            
                    
                    Chapter 23: Jointly Normal Random Variables
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.23.1" data-path="23_01_Random_Vectors.html">
            
                <a href="23_01_Random_Vectors.html">
            
                    
                    23.1 Random Vectors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.23.2" data-path="23_02_Multivariate_Normal_Distribution.html">
            
                <a href="23_02_Multivariate_Normal_Distribution.html">
            
                    
                    23.2 Multivariate Normal Distribution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.23.3" data-path="23_03_Linear_Combinations.html">
            
                <a href="23_03_Linear_Combinations.html">
            
                    
                    23.3 Linear Combinations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.23.4" data-path="23_04_Independence.html">
            
                <a href="23_04_Independence.html">
            
                    
                    23.4 Independence
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.24" data-path="24_00_Simple_Linear_Regression.html">
            
                <a href="24_00_Simple_Linear_Regression.html">
            
                    
                    Chapter 24: Simple Linear Regression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.24.1" data-path="24_01_Bivariate_Normal_Distribution.html">
            
                <a href="24_01_Bivariate_Normal_Distribution.html">
            
                    
                    24.1 Bivariate Normal Distribution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.24.2" data-path="24_02_Linear_Least_Squares.html">
            
                <a href="24_02_Linear_Least_Squares.html">
            
                    
                    24.2 Least Squares Linear Predictor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.24.3" data-path="24_03_Regression_and_Bivariate_Normal.html">
            
                <a href="24_03_Regression_and_Bivariate_Normal.html">
            
                    
                    24.3 Regression and the Bivariate Normal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.24.4" data-path="24_04_Regression_Equation.html">
            
                <a href="24_04_Regression_Equation.html">
            
                    
                    24.4 The Regression Equation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.25" data-path="25_00_Multiple_Regression.html">
            
                <a href="25_00_Multiple_Regression.html">
            
                    
                    Chapter 25: Multiple Regression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.25.1" data-path="25_01_Bilinearity_in_Matrix_Notation.html">
            
                <a href="25_01_Bilinearity_in_Matrix_Notation.html">
            
                    
                    25.1 Bilinearity in Matrix Notation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.25.2" data-path="25_02_Best_Linear_Predictor.html">
            
                <a href="25_02_Best_Linear_Predictor.html">
            
                    
                    25.2 Best Linear Predictor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.25.3" data-path="25_03_Multivariate_Normal_Regression.html">
            
                <a href="25_03_Multivariate_Normal_Regression.html">
            
                    
                    25.3 Regression and the Multivariate Normal
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >10.3 Long Run Behavior</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="long-run-behavior">Long Run Behavior</h2>
<div id="ipython-notebook">
            <a class="interact-button" href="http://prob140.berkeley.edu/hub/user-redirect/git-pull?repo=https://github.com/prob140/materials&amp;branch=gh-pages&amp;subPath=textbook/10_03_Long_Run_Behavior.ipynb" target="_blank">Interact</a>

<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Long-Run-Behavior">Long Run Behavior<a class="anchor-link" href="#Long-Run-Behavior">&#xB6;</a></h2></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Every irreducible and aperiodic Markov Chain with a finite state space exhibits astonishing regularity after it has run for a while. The proof of the convergence theorem below is beyond the scope of this course, but you have seen the result by computation. All the results are true in greater generality, for some classes of Markov Chains on infinitely many states.</p>
<h3 id="Convergence-to-Stationarity">Convergence to Stationarity<a class="anchor-link" href="#Convergence-to-Stationarity">&#xB6;</a></h3><p>Let $X_0, X_1, \ldots$ be an irreducible, aperiodic Markov chain on a finite state space $S$. Then for all states $i$ and $j$,</p>
$$
P_n(i, j) \to \pi(j) ~~~ \text{as } n \to \infty
$$<p>In other words, for every $i$ and $j$ in $S$, the $n$-step transition probability from $i$ to $j$ converges to a limit that does not depend on $i$. Moreover,</p>
<ul>
<li><p>$\pi(j) &gt; 0$ for all states $j$, and</p>
</li>
<li><p>$\sum_{j \in S} \pi(j) = 1$</p>
</li>
</ul>
<p>That is, as $n \to \infty$, every row of the $n$-step transition matrix $\mathbb{P}^n$ converges to the same vector $\pi$ which is a probability distribution in which all the terms are positive.</p>
<h3 id="Properties-of-the-Limit">Properties of the Limit<a class="anchor-link" href="#Properties-of-the-Limit">&#xB6;</a></h3><p><strong>(i)</strong> The vector $\pi$ is the unique solution of the <em>balance equations</em> $\pi \mathbb{P} = \pi$.</p>
<p><strong>(ii)</strong> If for some $n$ the distribution of $X_n$ is $\pi$, then the distribution of $X_m$ is also $\pi$ for all $m &gt; n$. Thus $\pi$ is called the <em>stationary</em> or <em>steady state</em> distribution of the chain.</p>
<p><strong>(iii)</strong> For each state $j$, the $j$th entry of the $\pi$ vector $\pi(j)$ is the expected long run proportion of time the chain spends at $j$.</p>
<p>We will assume that the convergence theorem is true; then the other properties follow rather easily. In the remainder of this section we will establish the properties and see how they are used.</p>
<h3 id="Balance-Equations">Balance Equations<a class="anchor-link" href="#Balance-Equations">&#xB6;</a></h3><p>Let $n \ge 0$ and let $i$ and $j$ be two states. Then</p>
$$
P_{n+1}(i, j) = \sum_{k \in S} P_n(i, k)P(k, j)
$$<p>Therefore</p>
\begin{align*}
\lim_{n \to \infty} P_{n+1}(i, j) &amp;= \lim_{n \to \infty} \sum_{k \in S} P_n(i, k)P(k, j) \\ \\
&amp;= \sum_{k \in S} \big{(} \lim_{n \to \infty} P_n(i, k) \big{)} P(k, j)
\end{align*}<p>We can exchange the limit and the sum because $S$ is finite. Now apply the theorem on convergence to stationarity:</p>
$$
\pi(j) = \sum_{k \in S} \pi(k)P(k, j)
$$<p>These are called the <em>balance equations</em>.</p>
<p>In matrix notation, if you think of $\pi$ as a row vector, these equations become</p>
$$
\pi = \pi \mathbb{P} ~~~~~ \text{or, equivalently,} ~~~~~ \pi\mathbb{P} = \pi
$$<p>This helps us compute $\pi$ without taking limits.</p>
<p><strong>Note:</strong> The steady state isn&apos;t an element of the state space $S$. It&apos;s the condition of the chain after it has been run for a long time. Let&apos;s examine this further.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Balance-and-Steady-State">Balance and Steady State<a class="anchor-link" href="#Balance-and-Steady-State">&#xB6;</a></h3><p>To see what is being &quot;balanced&quot; in these equations, imagine a large number of independent replications of this chain. For example, imagine a large number of particles that are moving among the states 1 through 5 according to the transition probabilities of the sticky reflecting walk, and suppose all the particles are moving at instants 1, 2, 3, $\ldots$ independently of each other.</p>
<p>Then at any instant and for any state $j$, there is some proportion of particles that is leaving $j$, and another proportion that is entering $j$. The balance equations say that those two proportions are equal.</p>
<p>Let&apos;s check this by looking at the equations again: for any state $j$,</p>
$$
\pi(j) = \sum_{k \in S} \pi(k)P(k, j)
$$<p>For every $k \in S$ (including $k=j$), think of $\pi(k)$ as the proportion of particles leaving state $k$ after the chain has been run a long time. Then the left hand side is the proportion leaving $j$. The generic term in the sum on the right is the proportion that left $k$ at the previous instant and are moving to $j$. The sum is all the particles entering $j$. When the two sides are equal, the chain is <em>balanced</em>.</p>
<p>The theorem on convergence to stationarity says that the chain approaches balance as $n$ gets large. If it actually achieves balance, that is, if the distribution of $X_n$ is $\pi$ for some $n$, then it stays balanced. The reason:</p>
$$
P(X_{n+1} = j) = \sum_{i \in S} P(X_n = i)P(i, j) = \sum_{i \in S} \pi(i)P(i, j) = \pi(j)
$$<p>by the balance equations. Now use induction.</p>
<p>In particular, if you start the chain with its stationary distribution $\pi$, then the distribution of $X_n$ is $\pi$ for every $n$.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Uniqueness">Uniqueness<a class="anchor-link" href="#Uniqueness">&#xB6;</a></h3><p>It&apos;s not very hard to show that if a probability distribution solves the balance equations, then it has to be $\pi$, the limit of the marginal distributions of $X_n$. We won&apos;t do the proof; it essentially repeats the steps we took to derive the balance equations. You should just be aware that an irreducible, aperiodic, finite state Markov Chain has exactly one stationary distribution.</p>
<p>This is particularly helpful if you happen to guess a solution to the balance equations. If the solution that you have guessed is a probability distribution, you have found the stationary distribution of the chain.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Expected-Long-Run-Proportion-of-Time">Expected Long Run Proportion of Time<a class="anchor-link" href="#Expected-Long-Run-Proportion-of-Time">&#xB6;</a></h3><p>Let $j$ be a state, and let $I_m(j)$ be the indicator of the event $\{X_m = j\}$. The <em>proportion of time the chain spends at $j$</em>, from time 1 through time $n$, is</p>
$$
\frac{1}{n} \sum_{m=1}^n I_m(j)
$$<p>Therefore, the <em>expected proportion of time the chain spends at $j$</em>, given that it started at $i$, is</p>
$$
\frac{1}{n} \sum_{m=1}^n E(I_m(j) \mid X_0 = i) 
= \frac{1}{n} \sum_{m=1}^n P(X_m = j \mid X_0 = i) 
= \frac{1}{n} \sum_{m=1}^n P_m(i, j)
$$<p>Now recall a property of convergent sequences of real numbers: If $x_n \to x$ as $n \to \infty$, then the sequence of averages also converges to $x$:
$$
\frac{1}{n} \sum_{m=1}^n x_m \to x ~~~ \text{as } n \to \infty
$$</p>
<p>Take $x_n = P_n(i, j)$. Then by the theorem on convergence to stationarity,</p>
$$
P_n(i, j) \to \pi(j) ~~~ \text{as } n \to \infty
$$<p>and hence the averages also converge:
$$
\frac{1}{n} \sum_{m=1}^n P_m(i, j) \to \pi(j) ~~~ \text{as } n \to \infty
$$</p>
<p>Thus the long run expected proportion of time the chain spends in state $j$ is $\pi(j)$, where $\pi$ is the stationary distribution of the chain.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Stationary-Distribution-of-Sticky-Reflecting-Walk">Stationary Distribution of Sticky Reflecting Walk<a class="anchor-link" href="#Stationary-Distribution-of-Sticky-Reflecting-Walk">&#xB6;</a></h3><p>We studied this in an earlier section. The transition diagram is</p>
<p><img alt="Lazy Circle Walk" src="trans_refl.png"></p>
<p>Here is the transition matrix $\mathbb{P}$.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reflecting_walk</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.50</td>
      <td>0.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.25</td>
      <td>0.50</td>
      <td>0.25</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.50</td>
      <td>0.25</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.50</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.50</td>
      <td>0.50</td>
    </tr>
  </tbody>
</table></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>MarkovChain</code> method <code>steady_state</code> returns the stationary distribution $\pi$. You saw earlier that this is the limit of the rows of $\mathbb{P}$.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reflecting_walk</span><span class="o">.</span><span class="n">steady_state</span><span class="p">()</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Value</th> <th>Probability</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1    </td> <td>0.125      </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>2    </td> <td>0.25       </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>3    </td> <td>0.25       </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>4    </td> <td>0.25       </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>5    </td> <td>0.125      </td>
        </tr>
    </tbody>
</table></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We could also solve for $\pi$ using the balance equations. While this might seem superfluous given that Python has already given us $\pi$, it is good practice for when transition matrices are larger and not numerical.</p>
<p>According to the balance equations,</p>
$$
\pi(1) = \sum_{k=1}^s \pi(k)P(k, 1)
$$<p>That is, we&apos;re multiplying $\pi$ by the <code>1</code> column of $\mathbb{P}$ and adding. So</p>
$$
\pi(1) = \pi(1)\cdot 0.5 ~ + ~ \pi(2) \cdot 0.25 = 0.5\pi(1) + 0.25\pi(2)
$$<p>Follow the same process to get all five balance equations:</p>
\begin{align*}
\pi(1) &amp;= 0.5\pi(1) + 0.25\pi(2) \\
\pi(2) &amp;= 0.5\pi(1) + 0.5\pi(2) + 0.25\pi(3) \\
\pi(3) &amp;= 0.25\pi(2) + 0.5\pi(3) + 0.25\pi(4) \\
\pi(4) &amp;= 0.25\pi(3) + 0.5\pi(4) + 0.5\pi(5) \\
\pi(5) &amp;= 0.25\pi(4) + 0.5\pi(5)
\end{align*}<p>Some observations make the system easy to solve.</p>
<ul>
<li>By rearranging the first equation, we get $\pi(2) = 2\pi(1)$.</li>
<li>By symmetry, $\pi(1) = \pi(5)$ and $\pi(2) = \pi (4)$.</li>
<li>Because $\pi(2) = \pi(4)$, the equation for $\pi(3)$ shows that $\pi(3) = \pi(2) = \pi(4)$.</li>
</ul>
<p>So the distribution $\pi$ is
$$
\big{(} \pi(1), 2\pi(1), 2\pi(1), 2\pi(1), \pi(1) \big{)}
$$</p>
<p>As $\pi$ is a probability distribution, it sums to 1. Its total is $8\pi(1)$, so we have</p>
$$
\pi = \big{(} \frac{1}{8}, \frac{2}{8}, \frac{2}{8}, \frac{2}{8}, \frac{1}{8} \big{)}
$$<p>This agrees with what we got by using <code>distribution</code> for $n=100$. In fact we could just have used the method <code>steady_state</code> to get $\pi$:</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This implies that in the long run, the lazy reflecting random walk of this section is expected to spend about 12.5% of its time at state 1, 25% of its time at each of states 2, 3, and 4, and the remaining 12.5% of its time at state 5.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Lazy-Random-Walk-on-a-Circle">Lazy Random Walk on a Circle<a class="anchor-link" href="#Lazy-Random-Walk-on-a-Circle">&#xB6;</a></h3><p>Now let the state space be five points arranged on a circle. Suppose the process starts at Point 1, and at each step either stays in place with probability 0.5 (and thus is sticky), or moves to one of the two neighboring points with chance 0.25 each, regardless of the other moves.</p>
<p>In other words, this walk is just the same as the sticky reflecting walk, except that $1 \rightarrow 5$ and $5 \rightarrow 1$ transitions are both possible. This transition behavior can be summed up in a transition diagram. Notice that the transition behavior is the same for all the states.</p>
<p><img alt="Lazy Circle Walk" src="trans_circle.png"></p>
<p>At every step, the next move is determined by a random choice from among three options and by the chain&apos;s current location, not on how it got to that location. So the process is a Markov chain. Let&apos;s call it $X_0, X_1, X_2, \ldots $ and define its transition matrix.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">circle_walk_probs</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">-</span><span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.5</span>
        <span class="k">elif</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.25</span>
        <span class="k">elif</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.25</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>   

<span class="n">circle_walk</span> <span class="o">=</span> <span class="n">MarkovChain</span><span class="o">.</span><span class="n">from_transition_function</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">circle_walk_probs</span><span class="p">)</span>
</pre></div></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">circle_walk</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.50</td>
      <td>0.25</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.25</td>
      <td>0.50</td>
      <td>0.25</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.50</td>
      <td>0.25</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.50</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.25</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.50</td>
    </tr>
  </tbody>
</table></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Because of the symmetry of the transition behavior, no state should be occupied more than any other state, and hence all the $\pi(j)$&apos;s should be equal. This is confirmed by <code>steady_state</code>.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">circle_walk</span><span class="o">.</span><span class="n">steady_state</span><span class="p">()</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Value</th> <th>Probability</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1    </td> <td>0.2        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>2    </td> <td>0.2        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>3    </td> <td>0.2        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>4    </td> <td>0.2        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>5    </td> <td>0.2        </td>
        </tr>
    </tbody>
</table></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div></div></div></div>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="10_02_Deconstructing_Chains.html" class="navigation navigation-prev " aria-label="Previous page: 10.2 Deconstructing Chains">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="10_04_Examples.html" class="navigation navigation-next " aria-label="Next page: 10.4 Examples">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"10.3 Long Run Behavior","level":"2.10.3","depth":2,"next":{"title":"10.4 Examples","level":"2.10.4","depth":2,"path":"notebooks-md/10_04_Examples.md","ref":"notebooks-md/10_04_Examples.md","articles":[]},"previous":{"title":"10.2 Deconstructing Chains","level":"2.10.2","depth":2,"path":"notebooks-md/10_02_Deconstructing_Chains.md","ref":"notebooks-md/10_02_Deconstructing_Chains.md","articles":[]},"dir":"ltr"},"config":{"plugins":["addcssjs","collapsible-menu"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"addcssjs":{"css":[],"js":["js/custom.js"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"fontsettings":{"theme":"white","family":"sans","size":2},"collapsible-menu":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"links":{"sidebar":{"Main Prob140 Site":"http://prob140.org/"}},"gitbook":"*"},"file":{"path":"notebooks-md/10_03_Long_Run_Behavior.md","mtime":"2018-08-10T20:32:00.840Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-08-10T20:43:55.712Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    
    <script type="text/javascript" src="../js/custom.js"></script>
    

    </body>
</html>

