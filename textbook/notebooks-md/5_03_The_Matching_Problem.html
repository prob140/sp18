
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>5.3 The Matching Problem Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="5_04_Sampling_Without_Replacement.html" />
    
    
    <link rel="prev" href="5_02_Inclusion_Exclusion.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="http://prob140.org/" target="_blank" class="custom-link">Main Prob140 Site</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Authors and License
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="To_the_Student.html">
            
                <a href="To_the_Student.html">
            
                    
                    To the Student
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="1_00_Fundamentals.html">
            
                <a href="1_00_Fundamentals.html">
            
                    
                    Chapter 1: Fundamentals
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="1_01_Outcome_Space_and_Events.html">
            
                <a href="1_01_Outcome_Space_and_Events.html">
            
                    
                    1.1 Outcome Space and Events
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="1_02_Equally_Likely_Outcomes.html">
            
                <a href="1_02_Equally_Likely_Outcomes.html">
            
                    
                    1.2 Equally Likely Outcomes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="1_03_Collisions_in_Hashing.html">
            
                <a href="1_03_Collisions_in_Hashing.html">
            
                    
                    1.3 Collisions in Hashing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="1_04_Birthday_Problem.html">
            
                <a href="1_04_Birthday_Problem.html">
            
                    
                    1.4 The Birthday Problem
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5" data-path="1_05_An_Exponential_Approximation.html">
            
                <a href="1_05_An_Exponential_Approximation.html">
            
                    
                    1.5 An Exponential Approximation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="2_00_Calculating_Chances.html">
            
                <a href="2_00_Calculating_Chances.html">
            
                    
                    Chapter 2: Calculating Chances
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="2_01_Addition.html">
            
                <a href="2_01_Addition.html">
            
                    
                    2.1 Addition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.2" data-path="2_02_Examples.html">
            
                <a href="2_02_Examples.html">
            
                    
                    2.2 Examples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.3" data-path="2_03_Multiplication.html">
            
                <a href="2_03_Multiplication.html">
            
                    
                    2.3 Multiplication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.4" data-path="2_04_More_Examples.html">
            
                <a href="2_04_More_Examples.html">
            
                    
                    2.4 More Examples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.5" data-path="2_05_Updating_Probabilities.html">
            
                <a href="2_05_Updating_Probabilities.html">
            
                    
                    2.5 Updating Probabilities
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="3_00_Random_Variables.html">
            
                <a href="3_00_Random_Variables.html">
            
                    
                    Chapter 3: Random Variables
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.1" data-path="3_01_Functions_on_an_Outcome_Space.html">
            
                <a href="3_01_Functions_on_an_Outcome_Space.html">
            
                    
                    3.1 Functions on an Outcome Space
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.2" data-path="3_02_Distributions.html">
            
                <a href="3_02_Distributions.html">
            
                    
                    3.2 Distributions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3" data-path="3_03_Equality.html">
            
                <a href="3_03_Equality.html">
            
                    
                    3.3 Equality
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="4_00_Relations_Between_Variables.html">
            
                <a href="4_00_Relations_Between_Variables.html">
            
                    
                    Chapter 4: Relations Between Variables
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.1" data-path="4_01_Joint_Distributions.html">
            
                <a href="4_01_Joint_Distributions.html">
            
                    
                    4.1 Joint Distributions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.2" data-path="4_02_Marginal_Distributions.html">
            
                <a href="4_02_Marginal_Distributions.html">
            
                    
                    4.2 Marginal Distributions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.3" data-path="4_03_Conditional_Distributions.html">
            
                <a href="4_03_Conditional_Distributions.html">
            
                    
                    4.3 Conditional Distributions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.4" data-path="4_04_Updating_Distributions.html">
            
                <a href="4_04_Updating_Distributions.html">
            
                    
                    4.4 Updating Distributions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.5" data-path="4_05_Dependence_and_Independence.html">
            
                <a href="4_05_Dependence_and_Independence.html">
            
                    
                    4.5 Dependence and Independence
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="5_00_Collections_of_Events.html">
            
                <a href="5_00_Collections_of_Events.html">
            
                    
                    Chapter 5: Collections of Events
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.5.1" data-path="5_01_Bounding_the_Chance_of_a_Union.html">
            
                <a href="5_01_Bounding_the_Chance_of_a_Union.html">
            
                    
                    5.1 Bounding the Chance of a Union
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.2" data-path="5_02_Inclusion_Exclusion.html">
            
                <a href="5_02_Inclusion_Exclusion.html">
            
                    
                    5.2 Inclusion-Exclusion
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.5.3" data-path="5_03_The_Matching_Problem.html">
            
                <a href="5_03_The_Matching_Problem.html">
            
                    
                    5.3 The Matching Problem
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.4" data-path="5_04_Sampling_Without_Replacement.html">
            
                <a href="5_04_Sampling_Without_Replacement.html">
            
                    
                    5.4 Sampling Without Replacement
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="6_00_Random_Counts.html">
            
                <a href="6_00_Random_Counts.html">
            
                    
                    Chapter 6: Random Counts
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.6.1" data-path="6_01_Binomial_Distribution.html">
            
                <a href="6_01_Binomial_Distribution.html">
            
                    
                    6.1 The Binomial Distribution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6.2" data-path="6_02_Examples.html">
            
                <a href="6_02_Examples.html">
            
                    
                    6.2 Examples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6.3" data-path="6_03_Hypergeometric_Distribution.html">
            
                <a href="6_03_Hypergeometric_Distribution.html">
            
                    
                    6.3 The Hypergeometric Distribution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6.4" data-path="6_04_Odds_Ratios.html">
            
                <a href="6_04_Odds_Ratios.html">
            
                    
                    6.4 Odds Ratios
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6.5" data-path="6_05_Law_of_Small_Numbers.html">
            
                <a href="6_05_Law_of_Small_Numbers.html">
            
                    
                    6.5 The Law of Small Numbers
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="7_00_Poissonization.html">
            
                <a href="7_00_Poissonization.html">
            
                    
                    Chapter 7: Poissonization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.7.1" data-path="7_01_Poissonizing_the_Binomial.html">
            
                <a href="7_01_Poissonizing_the_Binomial.html">
            
                    
                    7.1 Poissonizing the Binomial
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7.2" data-path="7_02_Poissonizing_the_Multinomial.html">
            
                <a href="7_02_Poissonizing_the_Multinomial.html">
            
                    
                    7.2 Poissonizing the Multinomial
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="8_00_Expectation.html">
            
                <a href="8_00_Expectation.html">
            
                    
                    Chapter 8: Expectation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.8.1" data-path="8_01_Definition.html">
            
                <a href="8_01_Definition.html">
            
                    
                    8.1 Definition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.8.2" data-path="8_02_Additivity.html">
            
                <a href="8_02_Additivity.html">
            
                    
                    8.2 Additivity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.8.3" data-path="8_03_Expectations_of_Functions.html">
            
                <a href="8_03_Expectations_of_Functions.html">
            
                    
                    8.3 Expectations of Functions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="9_00_Conditioning_Revisited.html">
            
                <a href="9_00_Conditioning_Revisited.html">
            
                    
                    Chapter 9: Conditioning, Revisited
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.9.1" data-path="9_01_Probability_by_Conditioning.html">
            
                <a href="9_01_Probability_by_Conditioning.html">
            
                    
                    9.1 Probability by Conditioning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.2" data-path="9_02_Expectation_by_Conditioning.html">
            
                <a href="9_02_Expectation_by_Conditioning.html">
            
                    
                    9.2 Expectation by Conditioning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.3" data-path="9_03_Expected_Waiting_Times.html">
            
                <a href="9_03_Expected_Waiting_Times.html">
            
                    
                    9.3 Expected Waiting Times
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.10" data-path="10_00_Markov_Chains.html">
            
                <a href="10_00_Markov_Chains.html">
            
                    
                    Chapter 10: Markov Chains
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.10.1" data-path="10_01_Transitions.html">
            
                <a href="10_01_Transitions.html">
            
                    
                    10.1 Transitions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.10.2" data-path="10_02_Deconstructing_Chains.html">
            
                <a href="10_02_Deconstructing_Chains.html">
            
                    
                    10.2 Deconstructing Chains
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.10.3" data-path="10_03_Long_Run_Behavior.html">
            
                <a href="10_03_Long_Run_Behavior.html">
            
                    
                    10.3 Long Run Behavior
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.10.4" data-path="10_04_Examples.html">
            
                <a href="10_04_Examples.html">
            
                    
                    10.4 Examples
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.11" data-path="11_00_Reversing_Markov_Chains.html">
            
                <a href="11_00_Reversing_Markov_Chains.html">
            
                    
                    Chapter 11: Reversing Markov Chains
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.11.1" data-path="11_01_Detailed_Balance.html">
            
                <a href="11_01_Detailed_Balance.html">
            
                    
                    11.1 Detailed Balance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.11.2" data-path="11_02_Reversibility.html">
            
                <a href="11_02_Reversibility.html">
            
                    
                    11.2 Reversibility
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.11.3" data-path="11_03_Code_Breaking.html">
            
                <a href="11_03_Code_Breaking.html">
            
                    
                    11.3 Code Breaking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.11.4" data-path="11_04_Markov_Chain_Monte_Carlo.html">
            
                <a href="11_04_Markov_Chain_Monte_Carlo.html">
            
                    
                    11.4 Markov Chain Monte Carlo
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.12" data-path="12_00_Standard_Deviation.html">
            
                <a href="12_00_Standard_Deviation.html">
            
                    
                    Chapter 12: Standard Deviation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.12.1" data-path="12_01_Definition.html">
            
                <a href="12_01_Definition.html">
            
                    
                    12.1 Definition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.12.2" data-path="12_02_Prediction_and_Estimation.html">
            
                <a href="12_02_Prediction_and_Estimation.html">
            
                    
                    12.2 Prediction and Estimation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.12.3" data-path="12_03_Bounds.html">
            
                <a href="12_03_Bounds.html">
            
                    
                    12.3 Tail Bounds
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.12.4" data-path="12_04_Heavy_Tails.html">
            
                <a href="12_04_Heavy_Tails.html">
            
                    
                    12.4 Heavy Tails
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.13" data-path="13_00_Variance_Via_Covariance.html">
            
                <a href="13_00_Variance_Via_Covariance.html">
            
                    
                    Chapter 13: Variance Via Covariance
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.13.1" data-path="13_01_Properties_of_Covariance.html">
            
                <a href="13_01_Properties_of_Covariance.html">
            
                    
                    13.1 Properties of Covariance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.13.2" data-path="13_02_Sums_of_IID_Samples.html">
            
                <a href="13_02_Sums_of_IID_Samples.html">
            
                    
                    13.2 Sums of IID Samples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.13.3" data-path="13_03_Sums_of_Simple_Random_Samples.html">
            
                <a href="13_03_Sums_of_Simple_Random_Samples.html">
            
                    
                    13.3 Sums of Simple Random Samples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.13.4" data-path="13_04_Finite_Population_Correction.html">
            
                <a href="13_04_Finite_Population_Correction.html">
            
                    
                    13.4 Finite Population Correction
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.14" data-path="14_00_The_Central_Limit_Theorem.html">
            
                <a href="14_00_The_Central_Limit_Theorem.html">
            
                    
                    Chapter 14: The Central Limit Theorem
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.14.1" data-path="14_01_Exact_Distribution.html">
            
                <a href="14_01_Exact_Distribution.html">
            
                    
                    14.1 Exact Distribution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.14.2" data-path="14_02_PGFs_in_NumPy.html">
            
                <a href="14_02_PGFs_in_NumPy.html">
            
                    
                    14.2 PGFs in NumPy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.14.3" data-path="14_03_Central_Limit_Theorem.html">
            
                <a href="14_03_Central_Limit_Theorem.html">
            
                    
                    14.3 Central Limit Theorem
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.14.4" data-path="14_04_The_Sample_Mean.html">
            
                <a href="14_04_The_Sample_Mean.html">
            
                    
                    14.4 The Sample Mean
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.14.5" data-path="14_05_Confidence_Intervals.html">
            
                <a href="14_05_Confidence_Intervals.html">
            
                    
                    14.5 Confidence Intervals
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.15" data-path="15_00_Continuous_Distributions.html">
            
                <a href="15_00_Continuous_Distributions.html">
            
                    
                    Chapter 15: Continuous Distributions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.15.1" data-path="15_01_Density_and_CDF.html">
            
                <a href="15_01_Density_and_CDF.html">
            
                    
                    15.1 Density and CDF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.15.2" data-path="15_02_The_Meaning_of_Density.html">
            
                <a href="15_02_The_Meaning_of_Density.html">
            
                    
                    15.2 The Meaning of Density
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.15.3" data-path="15_03_Expectation.html">
            
                <a href="15_03_Expectation.html">
            
                    
                    15.3 Expectation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.15.4" data-path="15_04_Exponential_Distribution.html">
            
                <a href="15_04_Exponential_Distribution.html">
            
                    
                    15.4 Exponential Distribution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.15.5" data-path="15_05_Calculus_in_SymPy.html">
            
                <a href="15_05_Calculus_in_SymPy.html">
            
                    
                    15.5 Calculus in SymPy
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.16" data-path="16_00_Transformations.html">
            
                <a href="16_00_Transformations.html">
            
                    
                    Chapter 16: Transformations
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.16.1" data-path="16_01_Linear_Transformations.html">
            
                <a href="16_01_Linear_Transformations.html">
            
                    
                    16.1 Linear Transformations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.16.2" data-path="16_02_Monotone_Functions.html">
            
                <a href="16_02_Monotone_Functions.html">
            
                    
                    16.2 Monotone Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.16.3" data-path="16_03_Two_to_One_Functions.html">
            
                <a href="16_03_Two_to_One_Functions.html">
            
                    
                    16.3 Two-to-One Functions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.17" data-path="17_00_Joint_Densities.html">
            
                <a href="17_00_Joint_Densities.html">
            
                    
                    Chapter 17: Joint Densities
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.17.1" data-path="17_01_Probabilities_and_Expectations.html">
            
                <a href="17_01_Probabilities_and_Expectations.html">
            
                    
                    17.1 Probabilities and Expectations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.17.2" data-path="17_02_Independence.html">
            
                <a href="17_02_Independence.html">
            
                    
                    17.2 Independence
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.17.3" data-path="17_03_Marginal_and_Conditional_Densities.html">
            
                <a href="17_03_Marginal_and_Conditional_Densities.html">
            
                    
                    17.3 Marginal and Conditional Densities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.17.4" data-path="17_04_Beta_Densities_with_Integer_Parameters.html">
            
                <a href="17_04_Beta_Densities_with_Integer_Parameters.html">
            
                    
                    17.4 Beta Densities with Integer Parameters
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.18" data-path="18_00_The_Normal_and_Gamma_Families.html">
            
                <a href="18_00_The_Normal_and_Gamma_Families.html">
            
                    
                    Chapter 18: The Normal and Gamma Families
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.18.1" data-path="18_01_Standard_Normal_Basics.html">
            
                <a href="18_01_Standard_Normal_Basics.html">
            
                    
                    18.1 Standard Normal: The Basics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.18.2" data-path="18_02_Sums_of_Independent_Normal_Variables.html">
            
                <a href="18_02_Sums_of_Independent_Normal_Variables.html">
            
                    
                    18.2 Sums of Independent Normal Variables
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.18.3" data-path="18_03_The_Gamma_Family.html">
            
                <a href="18_03_The_Gamma_Family.html">
            
                    
                    18.3 The Gamma Family
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.18.4" data-path="18_04_Chi_Squared_Distributions.html">
            
                <a href="18_04_Chi_Squared_Distributions.html">
            
                    
                    18.4 Chi-Squared Distributions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.19" data-path="19_00_Distributions_of_Sums.html">
            
                <a href="19_00_Distributions_of_Sums.html">
            
                    
                    Chapter 19: Distributions of Sums
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.19.1" data-path="19_01_Convolution_Formula.html">
            
                <a href="19_01_Convolution_Formula.html">
            
                    
                    19.1 The Convolution Formula
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.19.2" data-path="19_02_Moment_Generating_Functions.html">
            
                <a href="19_02_Moment_Generating_Functions.html">
            
                    
                    19.2 Moment Generating Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.19.3" data-path="19_03_MGFs_Normal_and_the_CLT.html">
            
                <a href="19_03_MGFs_Normal_and_the_CLT.html">
            
                    
                    19.3 MGFs, the Normal, and the CLT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.19.4" data-path="19_04_Chernoff_Bound.html">
            
                <a href="19_04_Chernoff_Bound.html">
            
                    
                    19.4 Chernoff Bound
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.20" data-path="20_00_Approaches_to_Estimation.html">
            
                <a href="20_00_Approaches_to_Estimation.html">
            
                    
                    Chapter 20: Approaches to Estimation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.20.1" data-path="20_01_Maximum_Likelihood.html">
            
                <a href="20_01_Maximum_Likelihood.html">
            
                    
                    20.1 Maximum Likelihood
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.20.2" data-path="20_02_Prior_and_Posterior.html">
            
                <a href="20_02_Prior_and_Posterior.html">
            
                    
                    20.2 Prior and Posterior
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.20.3" data-path="20_03_Independence_Revisited.html">
            
                <a href="20_03_Independence_Revisited.html">
            
                    
                    20.3 Independence, Revisited
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.21" data-path="21_00_The_Beta_and_the_Binomial.html">
            
                <a href="21_00_The_Beta_and_the_Binomial.html">
            
                    
                    Chapter 21: The Beta and the Binomial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.21.1" data-path="21_01_Updating_and_Prediction.html">
            
                <a href="21_01_Updating_and_Prediction.html">
            
                    
                    21.1 Updating and Prediction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.21.2" data-path="21_02_Beta_Binomial_Distribution.html">
            
                <a href="21_02_Beta_Binomial_Distribution.html">
            
                    
                    21.2 The Beta-Binomial Distribution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.21.3" data-path="21_03_Long_Run_Proportion_of_Heads.html">
            
                <a href="21_03_Long_Run_Proportion_of_Heads.html">
            
                    
                    21.3 Long Run Proportion of Heads
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.22" data-path="22_00_Prediction.html">
            
                <a href="22_00_Prediction.html">
            
                    
                    Chapter 22: Prediction
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.22.1" data-path="22_01_Conditional_Expectation_Projection.html">
            
                <a href="22_01_Conditional_Expectation_Projection.html">
            
                    
                    22.1 Conditional Expectation As a Projection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.22.2" data-path="22_02_Variance_by_Conditioning.html">
            
                <a href="22_02_Variance_by_Conditioning.html">
            
                    
                    22.2 Variance by Conditioning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.22.3" data-path="22_03_Examples.html">
            
                <a href="22_03_Examples.html">
            
                    
                    22.3 Examples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.22.4" data-path="22_04_Least_Squares_Predictor.html">
            
                <a href="22_04_Least_Squares_Predictor.html">
            
                    
                    22.4 Least Squares Predictor
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.23" data-path="23_00_Multivariate_Normal_RVs.html">
            
                <a href="23_00_Multivariate_Normal_RVs.html">
            
                    
                    Chapter 23: Jointly Normal Random Variables
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.23.1" data-path="23_01_Random_Vectors.html">
            
                <a href="23_01_Random_Vectors.html">
            
                    
                    23.1 Random Vectors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.23.2" data-path="23_02_Multivariate_Normal_Distribution.html">
            
                <a href="23_02_Multivariate_Normal_Distribution.html">
            
                    
                    23.2 Multivariate Normal Distribution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.23.3" data-path="23_03_Linear_Combinations.html">
            
                <a href="23_03_Linear_Combinations.html">
            
                    
                    23.3 Linear Combinations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.23.4" data-path="23_04_Independence.html">
            
                <a href="23_04_Independence.html">
            
                    
                    23.4 Independence
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.24" data-path="24_00_Simple_Linear_Regression.html">
            
                <a href="24_00_Simple_Linear_Regression.html">
            
                    
                    Chapter 24: Simple Linear Regression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.24.1" data-path="24_01_Bivariate_Normal_Distribution.html">
            
                <a href="24_01_Bivariate_Normal_Distribution.html">
            
                    
                    24.1 Bivariate Normal Distribution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.24.2" data-path="24_02_Linear_Least_Squares.html">
            
                <a href="24_02_Linear_Least_Squares.html">
            
                    
                    24.2 Least Squares Linear Predictor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.24.3" data-path="24_03_Regression_and_Bivariate_Normal.html">
            
                <a href="24_03_Regression_and_Bivariate_Normal.html">
            
                    
                    24.3 Regression and the Bivariate Normal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.24.4" data-path="24_04_Regression_Equation.html">
            
                <a href="24_04_Regression_Equation.html">
            
                    
                    24.4 The Regression Equation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.25" data-path="25_00_Multiple_Regression.html">
            
                <a href="25_00_Multiple_Regression.html">
            
                    
                    Chapter 25: Multiple Regression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.25.1" data-path="25_01_Bilinearity_in_Matrix_Notation.html">
            
                <a href="25_01_Bilinearity_in_Matrix_Notation.html">
            
                    
                    25.1 Bilinearity in Matrix Notation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.25.2" data-path="25_02_Best_Linear_Predictor.html">
            
                <a href="25_02_Best_Linear_Predictor.html">
            
                    
                    25.2 Best Linear Predictor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.25.3" data-path="25_03_Multivariate_Normal_Regression.html">
            
                <a href="25_03_Multivariate_Normal_Regression.html">
            
                    
                    25.3 Regression and the Multivariate Normal
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >5.3 The Matching Problem</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="the-matching-problem">The Matching Problem</h2>
<div id="ipython-notebook">
            <a class="interact-button" href="http://prob140.berkeley.edu/hub/user-redirect/git-pull?repo=https://github.com/prob140/materials&amp;branch=gh-pages&amp;subPath=textbook/5_03_The_Matching_Problem.ipynb" target="_blank">Interact</a>

<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Matching-Problem">The Matching Problem<a class="anchor-link" href="#The-Matching-Problem">&#xB6;</a></h2></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This famous problem has been stated variously in terms of hats and people, letters and envelopes, tea cups and saucers &#x2013; indeed, any situation in which you might want to match two kinds of items seems to have appeared somewhere as a setting for the matching problem.</p>
<p>In the letter-envelope setting there are $n$ letters labeled 1 through $n$ and also $n$ envelopes labeled 1 through $n$. The letters are permuted randomly into the envelopes, one letter per envelope (a mishap usually blamed on an unfortunate hypothetical secretary), so that all permutations are equally likely. The main questions are about the number of letters that are placed into their matching envelopes.</p>
<p>&quot;Real life&quot; settings aside, the problem is about the number of fixed points of a random permutation. A fixed point is an element whose position is unchanged by the shuffle.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Matches-at-Fixed-Locations">Matches at Fixed Locations<a class="anchor-link" href="#Matches-at-Fixed-Locations">&#xB6;</a></h3><p>Consider a random permutation of $n$ elements which for simplicity we will call $\{1, 2, \ldots , n\}$. For any $i$ in the range 1 through $n$, what is the chance that Position $i$ is a fixed point? In other words, what is the chance that letter $i$ falls in envelope $i$?</p>
<p>We know that there are $n!$ possible permutations, all of which are equally likely. To find $P(\text{match at Position }i)$ all we have to do is count the number of permutations that put letter $i$ in envelope $i$. Here is a good way to count these:</p>
<ul>
<li>Put letter $i$ in envelope $i$.</li>
<li>Once that is done, the remaining $n-1$ letters can be permuted in $(n-1)!$ ways.</li>
</ul>
<p>So
$$
P(\text{match at Position }i) = \frac{(n-1)!}{n!} 
= \frac{1}{n}
$$</p>
<p>Notice the absence of $i$ from the answer. No matter which position you fix, the chance of a match at that position is $1/n$. This formalizes the intuitive notion that each letter is equally likely to fall in any envelope, so the chance that it falls in the matching envelope is $1/n$.</p>
<p>Now fix any pair of positions $i \ne j$. To find $P(\text{matches at Positions } i \text{ and } j)$, extend the method we used above:</p>
<ul>
<li>Put letter $i$ in envelope $i$ and letter $j$ in envelope $j$.</li>
<li>Once that is done, the remaining $n-2$ letters can be permuted in $(n-2)!$ ways.</li>
</ul>
<p>So
$$
P(\text{matches at Positions } i \text{ and } j) = 
\frac{(n-2)!}{n!} 
= \frac{1}{n} \cdot \frac{1}{n-1}
$$</p>
<p>The second term in the product is 
$P(\text{match at } j \mid \text{match at } i)$ and is just the chance of a match at a fixed spot in the reduced set of $n-1$ letters after letter $i$ and envelope $i$ have been removed.</p>
<p>You should check by induction that for $k = 1, 2, \ldots , n$,
$$
P(\text{matches at a specified set of } k \text{ positions})
= \frac{1}{n} \cdot \frac{1}{n-1} \cdot \cdots \cdot \frac{1}{n-k+1}
$$</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="No-Matches">No Matches<a class="anchor-link" href="#No-Matches">&#xB6;</a></h3><p>If letters falling in the right envelopes are good events, then the worst possible event is every letter falling in a wrong envelope. That is the event that there are no matches, and is called a <em>derangement</em>. Let&apos;s find the chance of a derangement.</p>
<p>The key is to notice that the complement is a union, and then use the inclusion-exclusion formula.</p>
\begin{align*}P(\text{no match}) &amp;= 1 - P(\text{at least one match}) \\
&amp;= 1 - P\big{(}\bigcup_{i=1}^n \{\text{match at Position } i\} \big{)} \\
&amp;= 1 - P\big{(}\bigcup_{i=1}^n A_i \big{)}
\end{align*}<p>where $A_i$ is the event &quot;match at Position $i$&quot;.</p>
<p>By the inclusion-exclusion formula and our calculations above,</p>
\begin{align*}
&amp; P\big{(}\bigcup_{i=1}^n A_i \big{)} \\
&amp;=
\sum_{i=1}^n P(A_i) - \mathop{\sum \sum}_{1 \le i &lt; j \le n} P(A_iA_j) + \mathop{\sum \sum \sum}_{1 \le i &lt; j &lt; k \le n} P(A_iA_jA_j) - \cdots + (-1)^{n+1} P(A_1A_2 \ldots A_n) \\
&amp;= \sum_{i=1}^n \frac{1}{n} - \mathop{\sum \sum}_{1 \le i &lt; j \le n} \frac{1}{n} \cdot \frac{1}{n-1} + 
\mathop{\sum \sum \sum}_{1 \le i &lt; j &lt; k \le n}
\frac{1}{n} \cdot \frac{1}{n-1} \cdot \frac{1}{n-2} -
\cdots + (-1)^{n+1} \frac{1}{n!}
\end{align*}<p>If those sums look hair-raising, look again. None of the terms being added has an index ($i$, $j$, etc) in it! Each sum consists of adding a constant value multiple times, and is therefore equal to the constant times the number of terms in the sum.</p>
<p>The number of terms in the first sum is $n$. As we observed in an earlier section, the number of terms being added in the second sum is
$$
\frac{n(n-1)}{2!}
$$
In the third sum the number of terms is
$$
\frac{n(n-1)(n-2)}{3!}
$$
and so on. Therefore</p>
\begin{align*}
&amp; P\big{(}\bigcup_{i=1}^n A_i \big{)} \\ \\
&amp;= n \cdot \frac{1}{n}
~-~ \frac{n(n-1)}{2!} \cdot \frac{1}{n} \cdot \frac{1}{n-1}
~+~ \frac{n(n-1)(n-2)}{3!} \cdot \frac{1}{n} \cdot \frac{1}{n-1} \cdot \frac{1}{n-2} ~-~
\cdots + (-1)^{n+1} \frac{1}{n!} \\ \\
&amp;= 1 - \frac{1}{2!} + \frac{1}{3!} - \cdots (-1)^{n+1}\frac{1}{n!}
\end{align*}<p>Remember that
$$
P\big{(}\bigcup_{i=1}^n A_i \big{)} = 
P(\text{at least one match})
$$</p>
<p>So the chance of a derangement is</p>
\begin{align*}
P(\text{no match}) &amp;= 1 - \big{(}1 - \frac{1}{2!} + \frac{1}{3!} - \cdots (-1)^{n+1}\frac{1}{n!}\big{)} \\
&amp;= 1 - 1 + \frac{1}{2!} - \frac{1}{3!} + \cdots (-1)^n\frac{1}{n!} \\
&amp;\sim e^{-1}
\end{align*}<p>when $n$ is large.</p>
<p>In the language of random variables, let $M_n$ be the number of fixed points (matches) in a random permutation of $n$ elements. Then for every $n \ge 1$ we have an exact formula for the chance that $M_n$ is 0:</p>
$$
P(M_n = 0) = 1 - 1 + \frac{1}{2!} - \frac{1}{3!} + \cdots (-1)^n\frac{1}{n!}
$$<p>For large $n$, we also have an approximation:</p>
$$
P(M_n = 0) \sim e^{-1} = 36.8\%
$$<p>roughly. When $n$ is large, about 36.8% of all permutations of $n$ elements move all of the elements away from their original positions.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="$k$-Matches">$k$ Matches<a class="anchor-link" href="#$k$-Matches">&#xB6;</a></h3><p>For $0 \le k \le n$, you can find $P(M_n = k)$ by using the following observations.</p>
<ul>
<li>There are $\binom{n}{k}$ ways of fixing the $k$ places for the matches.</li>
<li>Once the places have been fixed, you have to get a match at those $k$ places; the chance of that is $1/(n(n-1) \cdots (n-k+1))$.</li>
<li>Given that there are matches at those $k$ places, there are $n-k$ letters left, with the corresponding $n-k$ envelopes, and there has to be a derangement of these. The conditional chance is equal to $P(M_{n-k} = 0)$.</li>
</ul>
<p>So for a fixed $k$ in the range $0 \le k \le n$,</p>
\begin{align*}
&amp; P(M_n = k) \\
&amp;= \binom{n}{k} \cdot \frac{1}{n(n-1) \cdots (n-k+1)} \cdot 
\big{(} 1 - 1 + \frac{1}{2!} - \frac{1}{3!} + \cdots (-1)^{n-k}\frac{1}{(n-k)!} \big{)} \\
&amp;= \frac{1}{k!} \cdot \big{(} 1 - 1 + \frac{1}{2!} - \frac{1}{3!} + \cdots (-1)^{n-k}\frac{1}{(n-k)!} \big{)} \\
&amp;\approx \frac{1}{k!} e^{-1} ~~~~~~~~~ \text{for large } n
\end{align*}<p>We will see later that these probabilities form a <em>Poisson</em> distribution on the infinite set of non-negative integers.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div></div></div></div>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="5_02_Inclusion_Exclusion.html" class="navigation navigation-prev " aria-label="Previous page: 5.2 Inclusion-Exclusion">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="5_04_Sampling_Without_Replacement.html" class="navigation navigation-next " aria-label="Next page: 5.4 Sampling Without Replacement">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"5.3 The Matching Problem","level":"2.5.3","depth":2,"next":{"title":"5.4 Sampling Without Replacement","level":"2.5.4","depth":2,"path":"notebooks-md/5_04_Sampling_Without_Replacement.md","ref":"notebooks-md/5_04_Sampling_Without_Replacement.md","articles":[]},"previous":{"title":"5.2 Inclusion-Exclusion","level":"2.5.2","depth":2,"path":"notebooks-md/5_02_Inclusion_Exclusion.md","ref":"notebooks-md/5_02_Inclusion_Exclusion.md","articles":[]},"dir":"ltr"},"config":{"plugins":["addcssjs","collapsible-menu"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"addcssjs":{"css":[],"js":["js/custom.js"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"fontsettings":{"theme":"white","family":"sans","size":2},"collapsible-menu":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"links":{"sidebar":{"Main Prob140 Site":"http://prob140.org/"}},"gitbook":"*"},"file":{"path":"notebooks-md/5_03_The_Matching_Problem.md","mtime":"2018-08-10T20:32:00.844Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-08-10T20:43:55.712Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    
    <script type="text/javascript" src="../js/custom.js"></script>
    

    </body>
</html>

