<div id="ipython-notebook">
            <a class="interact-button" href="http://prob140.berkeley.edu/hub/user-redirect/git-pull?repo=https://github.com/prob140/materials&branch=gh-pages&subPath=textbook/19_01_Convolution_Formula.ipynb">Interact</a>
            
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Convolution-Formula">The Convolution Formula<a class="anchor-link" href="#The-Convolution-Formula">¶</a></h2></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let $X$ and $Y$ be discrete random variables and let $S = X+Y$. We know that a good way to find the distribution of $S$ is to partition the event $\{ S = s\}$ according to values of $X$. That is,</p>
$$
P(S = s) ~ = ~ \sum_{\text{all }x} P(X = x, Y = s-x)
$$<p>If $X$ and $Y$ are independent, this becomes the <em>discrete convolution formula</em>:</p>
$$
P(S = s) ~ = ~ \sum_{\text{all }x} P(X = x)P(Y = s-x)
$$<p>This formula has a straightforward continuous analog. Let $X$ and $Y$ be continuous random variables with joint density $f$, and let $S = X+Y$. Then the density of $S$ is given by</p>
$$
f_S(s) ~ = ~ \int_{-\infty}^\infty f(x, s-x)dx
$$<p>which becomes the <em>convolution formula</em> when $X$ and $Y$ are independent:</p>
$$
f_S(s) ~ = ~ \int_{-\infty}^\infty f_X(x)f_Y(s-x)dx
$$</div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sum-of-Two-IID-Exponential-Random-Variables">Sum of Two IID Exponential Random Variables<a class="anchor-link" href="#Sum-of-Two-IID-Exponential-Random-Variables">¶</a></h3><p>Let $X$ and $Y$ be i.i.d. exponential $(\lambda)$ random variables and let $S = X+Y$. For the sum to be $s &gt; 0$, neither $X$ nor $Y$ can exceed $s$. The convolution formula says that the density of $S$ is given by</p>
\begin{align*}
f_S(s) ~ &amp;= ~ \int_0^s \lambda e^{-\lambda x} \lambda e^{-\lambda(s-x)} dx \\ \\
&amp;= ~ \lambda^2 e^{-\lambda s} \int_0^s dx \\ \\
&amp;=~  \lambda^2 s e^{-\lambda s}
\end{align*}<p>That's the gamma $(2, \lambda)$ density, consistent with the claim made in the previous chapter about sums of independent gamma random variables.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sometimes, the density of a sum can be found without the convolution formula.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sum-of-Two-IID-Uniform-$(0,-1)$-Random-Variables">Sum of Two IID Uniform $(0, 1)$ Random Variables<a class="anchor-link" href="#Sum-of-Two-IID-Uniform-$(0,-1)$-Random-Variables">¶</a></h3><p>Let $S = U_1 + U_2$ where the $U_i$'s are i.i.d. uniform on $(0, 1)$. The gold stripes in the graph below show the events $\{ S \in ds \}$ for various values of $S$.</p></div></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/19_01_Convolution_Formula_6_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The joint density surface is flat. So the shape of the density of $S$ depends only on the lengths of the stripes, which increase linearly between $s = 0$ and $s = 1$ and then decrease linearly between $s = 1$ and $s = 2$. So the joint density of $S$ is triangular. The height of the triangle is 1 since the area of the triangle has to be 1.</p></div></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/19_01_Convolution_Formula_8_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At the other end of the difficulty scale, the integral in the convolution formula can sometimes be quite intractable. In the rest of the chapter we will develop a different way of deriving distributions of sums.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div></div></div></div>