<div id="ipython-notebook">
            <a class="interact-button" href="http://prob140.berkeley.edu/hub/user-redirect/git-pull?repo=https://github.com/prob140/materials&branch=gh-pages&subPath=textbook/16_02_Monotone_Functions.ipynb">Interact</a>
            
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Monotone-Functions">Monotone Functions<a class="anchor-link" href="#Monotone-Functions">¶</a></h2></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The method we have developed for finding the density of a linear function of a random variable can be extended to non-linear functions. We will start with a setting in which you have seen that applying non-linear functions to a random variable can have useful results.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Simulation-via-the-CDF">Simulation via the CDF<a class="anchor-link" href="#Simulation-via-the-CDF">¶</a></h3><p>In exercises, you have seen by simulation that you can generate a value of a random variable with a specified distribution by using the cdf of the distribution and a uniform (0, 1) random number. We will now establish the theory that underlies what you discovered by computation.</p>
<p>Let $F$ be a differentiable, strictly increasing cdf on the real number line. The differentiability assumption allows you to find the corresponding density by differentiating.</p>
<p>Our goal is to generate a value of a random variable that has $F$ as its cdf. The statement below describes the process that you came up with in exercises. Note that because $F$ is continuous and strictly increasing, it has an inverse function.</p>
<p>Let $U$ have the uniform (0, 1) distribution. Define a random variable $X$ by the formula $X = F^{-1}(U)$, and let $F_X$ be the cdf of $X$. We will show that $F_X = F$ and thus that $X$ has the desired distribution.</p>
<p>To prove the result, remember that the cdf $F_U$ of $U$ is given by $F_U(u) = u$ for $0 &lt; u &lt; 1$. Let $x$ be any number. Our goal is to show that $F_X(x) = F(x)$.</p>
\begin{align*}
F_X(x) ~ &amp;= ~ P(X \le x) \\
&amp;= ~ P(F^{-1}(U) \le x) \\
&amp;= ~ P(U \le F(x)) ~~~~ \mbox{because } F \mbox{ is increasing} \\
&amp;= ~ F_U(F(x)) \\
&amp;= ~ F(x)
\end{align*}</div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Change-of-Variable-Formula-for-Density:-Increasing-Function">Change of Variable Formula for Density: Increasing Function<a class="anchor-link" href="#Change-of-Variable-Formula-for-Density:-Increasing-Function">¶</a></h3><p>The function $F^{-1}$ is differentiable and increasing. We will now develop a general method for finding the density of such a function applied to any random variable that has a density.</p>
<p>Let $X$ have density $f_X$. Let $g$ be a smooth (that is, differentiable) increasing function, and let $Y = g(X)$. Examples of such functions $g$ are:</p>
<ul>
<li>$g(x) = ax + b$ for some $a &gt; 0$. This case was covered in the previous section.</li>
<li>$g(x) = e^x$</li>
<li>$g(x) = \sqrt{x}$ on positive values of $x$</li>
</ul>
<p>To develop a formula for the density of $Y$ in terms of $f_X$ and $g$, we will start with the cdf as we did above.</p>
<p>Let $g$ be smooth and increasing, and let $Y = g(X)$. We want a formula for $f_Y$. We will start by finding a formula for the cdf $F_Y$ of $Y$ in terms of $g$ and the cdf $F_X$ of $X$.</p>
\begin{align*}
F_Y(y) ~ &amp; = ~ P(Y \le y) \\
&amp;= ~ P(g(X) \le y) \\
&amp;= ~ P(X \le g^{-1}(y)) ~~~~ \text{because } g \text{ is increasing} \\
&amp;= ~ F_X(g^{-1}(y))
\end{align*}<p>Now we can differentiate to find the density of $Y$. By the chain rule and the fact that the derivative of an inverse is the reciprocal of the derivative,</p>
\begin{align*}
f_Y(y) ~ &amp;= ~ f_X(g^{-1}(y)) \frac{d}{dy} g^{-1}(y) \\
&amp;= ~ f_X(x) \frac{1}{g'(x)} ~~~~~ \text{at } x = g^{-1}(y)
\end{align*}<h4 id="The-Formula">The Formula<a class="anchor-link" href="#The-Formula">¶</a></h4><p>Let $g$ be a differentiable, increasing function. The density of $Y = g(X)$ is given by
$$
f_Y(y) ~ = ~ f_X(x) \cdot \frac{1}{g'(x)} ~~~ \text{at } x = g^{-1}(y)
$$</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Understanding-the-Formula">Understanding the Formula<a class="anchor-link" href="#Understanding-the-Formula">¶</a></h3><p>To see what is going on in the calculation, we will follow the same process as we used for linear functions in an earlier section.</p>
<ul>
<li>For $Y$ to be $y$, $X$ has to be $g^{-1}(y)$.</li>
<li>Since $g$ need not be linear, the tranformation by $g$ won't necessarily stretch the horizontal axis by a constant factor. Instead, the factor has different values at each $x$. If $g'$ denotes the derivative of $g$, then the stretch factor at $x$ is $g'(x)$, the rate of change of $g$ at $x$. To make the total area under the density equal to 1, we have to compensate by dividing by $g'(x)$. This is valid because $g$ is increasing and hence $g'$ is positive.</li>
</ul>
<p>This gives us an intuitive justification for the formula.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Applying-the-Formula">Applying the Formula<a class="anchor-link" href="#Applying-the-Formula">¶</a></h3><p>Let $X$ have the exponential (1) density and let $Y = \sqrt{X}$. We can take the square root because $X$ is a positive random variable.</p>
<p>Let's find the density of $Y$ by applying the formula we have derived above. We will organize our calculation in four preliminary steps, and then plug into the formula.</p>
<ul>
<li><strong>The function:</strong> Take $g(x) = \sqrt{x}$. Then $g$ is increasing and its possible values are $(0, \infty)$.</li>
<li><strong>The derviative:</strong> The derivative of $g$ is given by $g'(x) = 1/2\sqrt{x}$.</li>
<li><strong>The inverse function:</strong> Let $y = g(x) = \sqrt{x}$. We will now write $x$ in terms of $y$, to get $x = y^2$.</li>
<li><strong>The known density:</strong> The density of $X$ is $f_X(x) = e^{-x}$ for $x &gt; 0$.</li>
</ul>
<p>We are ready to plug this into our formula. Keep in mind that the possible values of $Y$ are $(0, \infty)$. For $y &gt; 0$ the formula says</p>
$$
f_Y(y) ~ = ~ f_X(x) \cdot \frac{1}{g'(x)} ~~~ \text{at } x = g^{-1}(y)
$$<p>So for $y &gt; 0$,</p>
\begin{align*}
f_Y(y) ~ &amp;= ~ e^{-x} \cdot \frac{1}{1/2\sqrt{x}} ~~~~ \mbox{at } x = y^2 \\
&amp;= ~ 2\sqrt{x} e^{-x} ~~~~ \mbox{at } x = y^2 \\
&amp;= ~ 2\sqrt{y^2} e^{-y^2} \\
&amp;= ~ 2y e^{-y^2}
\end{align*}<p>This is the <em>Rayleigh</em> density. Its graph is shown below.</p></div></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/16_02_Monotone_Functions_7_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A log-normal density can be used as an approximation for the density of a product of a large number of i.i.d. random variables. The log of the product is the sum of a large number of i.i.d. variables, and hence is approximately normal by the Central Limit Theorem.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Change-of-Variable-Formula-for-Density:-Monotone-Function">Change of Variable Formula for Density: Monotone Function<a class="anchor-link" href="#Change-of-Variable-Formula-for-Density:-Monotone-Function">¶</a></h3><p>Let $g$ be smooth and monotone (that is, either increasing or decreasing). The density of $Y = g(X)$ is given by</p>
$$
f_Y(y) ~ = ~ f_X(x) \cdot \frac{1}{\lvert g'(x) \rvert} ~~~ \text{at } x = g^{-1}(y)
$$<p>We have proved the result for increasing $g$. When $g$ is decreasing, the proof is analogous to proof in the linear case and accounts for $g'$ being negative. We won't take the time to write it out.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Reciprocal-of-a-Uniform-Variable">Reciprocal of a Uniform Variable<a class="anchor-link" href="#Reciprocal-of-a-Uniform-Variable">¶</a></h3><p>Let $U$ be uniform on $(0, 1)$ and let $V = 1/U$. The distribution of $V$ is called the <em>inverse uniform</em> but the word "inverse" is confusing in the context of change of variable. So we will simply call $V$ the reciprocal of $U$.</p>
<p>To find the density of $V$, start by noticing that the possible values of $V$ are in $(1, \infty)$ as the possible values of $U$ are in $(0, 1)$.</p>
<p>The components of the change of variable formula for densities:</p>
<ul>
<li><strong>The function:</strong> Define $g(u) = 1/u$.</li>
<li><strong>The derivative:</strong> Then $g'(u) = -u^{-2}$.</li>
<li><strong>The inverse function:</strong> Let $v = g(u) = 1/u$. Then $u = g^{-1}(v) = 1/v$.</li>
<li><strong>The known density:</strong> $f_U(u) = 1$ for $0 &lt; u &lt; 1$.</li>
</ul>
<p>By the formula, for $v &gt; 1$ we have
$$
f_V(v) ~ = ~ f_U(u) \cdot \frac{1}{\lvert g'(u) \rvert} ~~~ \text{at } u = g^{-1}(v)
$$</p>
<p>That is, for $v &gt; 1$,
$$
f_V(v) ~ = ~ 1 \cdot u^2 ~~~ \text{at } u = 1/v
$$
So 
$$
f_V(v) ~ = ~ \frac{1}{v^2}, ~~~ v &gt; 1
$$</p>
<p>You should check that $f_V$ is indeed a density, that is, it integrates to 1. You should also check that the expectation of $V$ is infinite.</p>
<p>The density $f_V$ belongs to the <em>Pareto</em> family of densities, much used in economics.</p></div></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/16_02_Monotone_Functions_11_0.png"/></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div></div></div></div>